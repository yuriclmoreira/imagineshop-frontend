import { useContext, useEffect, useState } from "react";
import Head from "next/head";
import { faX } from '@fortawesome/free-solid-svg-icons';
import { ShoppingCartContext } from "@/contexts/ShoppingCartContext";
import { IProduct } from "@/types";
import Image from "next/image";
import { ButtonContainer, DeleteIcon, Main, Product, ProductName, ProductPrice, Separator, ShoppingCartContainer, SubTitle, Title } from "./styles";


export default function ShoppingCart() {
    const { getProducts } = useContext(ShoppingCartContext);
    const [products, setProduts] = useState<IProduct[]>([]);

    useEffect(() => {
        const values = getProducts();
        setProduts(values)
    }, [getProducts])

    return (
        <>
            <Head>
                <title>ImagineShop - Cart</title>
                <meta name="description" content="Generated by create next app" />
                <meta name="viewport" content="width=device-width, initial-scale=1" />
                <link rel="icon" href="/logo.ico" />
            </Head>
            <Main>
                <Title>Meu carrinho</Title>
                <SubTitle>Produtos</SubTitle>
                <ShoppingCartContainer>
                    <section>
                        <Separator />
                        {
                            products && products.map(product => (
                                <div key={product._id}>
                                    <ButtonContainer>
                                        <button>

                                            <DeleteIcon icon={faX}></DeleteIcon>
                                        </button>
                                    </ButtonContainer>
                                    <Product>
                                        <div>
                                            <Image src={product.image} width={180} height={180} alt={product.name} />
                                        </div>
                                        <ProductName>{product.name}</ProductName>
                                        <ProductPrice>{product.formattedPrice}</ProductPrice>
                                    </Product>
                                    <Separator />
                                </div>
                            ))
                        }
                    </section>

                </ShoppingCartContainer>
            </Main>
        </>

    )
}